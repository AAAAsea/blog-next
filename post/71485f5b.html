<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="https://blog.asea.fun/img/avatar1.png"><link rel="icon" type="image/png" sizes="16x16" href="https://blog.asea.fun/img/avatar1.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-big-counter.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"asea.fun",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"default"},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="记录一下python常用的源码邮件服务 用来每次部署博客以后给订阅的人自动发邮件  &lt;!-- 邮件服务 --&gt;# coding: UTF-8import smtplibfrom email.mime.text import MIMETextmailserver &#x3D; &quot;smtp.163.com&quot;  #邮箱服务器地址username_send &#x3D; &amp;"><meta property="og:type" content="article"><meta property="og:title" content="python项目练习"><meta property="og:url" content="https://asea.fun/post/71485f5b.html"><meta property="og:site_name" content="AseaBlog"><meta property="og:description" content="记录一下python常用的源码邮件服务 用来每次部署博客以后给订阅的人自动发邮件  &lt;!-- 邮件服务 --&gt;# coding: UTF-8import smtplibfrom email.mime.text import MIMETextmailserver &#x3D; &quot;smtp.163.com&quot;  #邮箱服务器地址username_send &#x3D; &amp;"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-03-27T03:44:22.000Z"><meta property="article:modified_time" content="2021-03-30T03:56:45.000Z"><meta property="article:author" content="Asea"><meta property="article:tag" content="python"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://asea.fun/post/71485f5b.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>python项目练习 | AseaBlog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="AseaBlog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta custom-logo"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">AseaBlog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">我的个人博客</p> <a><img class="custom-logo-image" src="/uploads/logo2.png" alt="AseaBlog"></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-主页"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> 主页</a></li><li class="menu-item menu-item-关于"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i> 关于</a></li><li class="menu-item menu-item-标签"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-分类"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> 分类</a></li><li class="menu-item menu-item-留言"><a href="/liuyan/" rel="section"><i class="fa fa-comments fa-fw"></i> 留言</a></li><li class="menu-item menu-item-归档"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/AAAAsea" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://asea.fun/post/71485f5b.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar1.png"><meta itemprop="name" content="Asea"><meta itemprop="description" content="我以為我可以獨自過一生 我還是被打動了"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="AseaBlog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> python项目练习</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-03-27 11:44:22" itemprop="dateCreated datePublished" datetime="2021-03-27T11:44:22+08:00">2021-03-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-03-30 11:56:45" itemprop="dateModified" datetime="2021-03-30T11:56:45+08:00">2021-03-30</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span></span><span class="post-meta-item" title="热度" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">热度：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/post/71485f5b.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/post/71485f5b.html" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="记录一下python常用的源码"><a href="#记录一下python常用的源码" class="headerlink" title="记录一下python常用的源码"></a>记录一下python常用的源码</h1><h2 id="邮件服务"><a href="#邮件服务" class="headerlink" title="邮件服务"></a>邮件服务</h2><blockquote><p>用来每次部署博客以后给订阅的人自动发邮件</p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 邮件服务 --&gt;</span><br><span class="line"># coding: UTF-8</span><br><span class="line">import smtplib</span><br><span class="line">from email.mime.text import MIMEText</span><br><span class="line">mailserver &#x3D; &quot;smtp.163.com&quot;  #邮箱服务器地址</span><br><span class="line">username_send &#x3D; &#39;******@163.com,xxx@qq.com&#39;  #邮箱用户名</span><br><span class="line">password &#x3D; &#39;******&#39;   #邮箱密码：需要使用授权码</span><br><span class="line">username_recv &#x3D; &#39;****@qq.com&#39;  #收件人，多个收件人用逗号隔开</span><br><span class="line">mail &#x3D; MIMEText(&#39;xxx&#39;)</span><br><span class="line">mail[&#39;Subject&#39;] &#x3D; &#39;xxx&#39;</span><br><span class="line">mail[&#39;From&#39;] &#x3D; username_send  #发件人</span><br><span class="line">mail[&#39;To&#39;] &#x3D; username_recv  #收件人；[]里的三个是固定写法，别问为什么，我只是代码的搬运工</span><br><span class="line">smtp &#x3D; smtplib.SMTP(mailserver,port&#x3D;25) # 连接邮箱服务器，smtp的端口号是25</span><br><span class="line"># smtp&#x3D;smtplib.SMTP_SSL(&#39;smtp.qq.com&#39;,port&#x3D;465) #QQ邮箱的服务器和端口号</span><br><span class="line">smtp.login(username_send,password)  #登录邮箱</span><br><span class="line">smtp.sendmail(username_send,username_recv,mail.as_string())# 参数分别是发送者，接收者，第三个是把上面的发送邮件的内容变成字符串</span><br><span class="line">smtp.quit() # 发送完毕后退出smtp</span><br><span class="line">print (&#39;success&#39;)</span><br></pre></td></tr></table></figure><h2 id="自动更新更新时间"><a href="#自动更新更新时间" class="headerlink" title="自动更新更新时间"></a>自动更新更新时间</h2><blockquote><p>每次部署的时候自动将post的<code>update:</code>后面的时间改成文件的修改时间</p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 自动更新更新时间和文件名 --&gt;</span><br><span class="line">import re</span><br><span class="line">import time</span><br><span class="line">import os</span><br><span class="line">def change_time(path):</span><br><span class="line">        fileList &#x3D; os.listdir(path)</span><br><span class="line">        fb &#x3D; open(&#39;更新内容.txt&#39;,&#39;w&#39;,encoding &#x3D; &#39;utf-8&#39;)</span><br><span class="line">        hello &#x3D; &#39;博客更新&#39;</span><br><span class="line">        fb.write(&#39;&#123;:⭐^10&#125;\n&#39;.format(hello))</span><br><span class="line">        for file in fileList:</span><br><span class="line">            allpath &#x3D; path+file</span><br><span class="line">            f &#x3D; open(allpath,&#39;r&#39;,encoding&#x3D;&#39;utf-8&#39;)</span><br><span class="line">            txt &#x3D; f.read() #读取内容</span><br><span class="line">            f.close()</span><br><span class="line">            now &#x3D; int(time.time())</span><br><span class="line">            # 匹配，加入\n是为了防止匹配到文章内部代码。</span><br><span class="line">            old_update &#x3D; re.findall(r&quot;(updated: \d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;\s\d&#123;1,2&#125;:\d&#123;1,2&#125;:\d&#123;1,2&#125;\n)&quot;,txt) # 正则匹配要修改的字符串</span><br><span class="line">            file_title &#x3D; re.findall(r&#39;title: (.*?)\n&#39;,txt)</span><br><span class="line">            if old_update &#x3D;&#x3D; []:</span><br><span class="line">                    old_update &#x3D; [&#39;updated:\n&#39;]</span><br><span class="line">            new_update &#x3D; time.strftime(&#39;updated: %Y-%m-%d %H:%M:%S\n&#39;,time.localtime(int(os.path.getmtime(allpath)))) # 获取文件的最后修改时间并赋值</span><br><span class="line">            </span><br><span class="line">            try:</span><br><span class="line">                txt &#x3D; txt.replace(old_update[0],new_update) # 替换</span><br><span class="line">            except:</span><br><span class="line">                print(&#39;&#123;&#125;有误&#39;.format(file))</span><br><span class="line">                continue</span><br><span class="line">            else:</span><br><span class="line">                if now - int(os.path.getmtime(allpath)) &lt; 43200:</span><br><span class="line">                    fi &#x3D; open(allpath,&#39;w&#39;,encoding &#x3D; &#39;utf-8&#39;)</span><br><span class="line">                    fi.write(txt) # 写入</span><br><span class="line">                    fi.close() # 关闭</span><br><span class="line">                    os.rename(allpath,path+file_title[0]+os.path.splitext(allpath)[1])</span><br><span class="line">                    update_name &#x3D; &#39;《&#39;+file_title[0]+&#39;》&#39;</span><br><span class="line">                    fb.write(&#39;------------&#123;&#125;\n&#39;.format(update_name))</span><br><span class="line">        fb.write(&#39;\n访问地址：https:&#x2F;&#x2F;blog.asea.fun&#39;)</span><br><span class="line">        fb.close()</span><br><span class="line">change_time(&#39;E:&#x2F;blog&#x2F;source&#x2F;_posts&#x2F;&#39;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="自己写了一个文件名字批处理的软件"><a href="#自己写了一个文件名字批处理的软件" class="headerlink" title="自己写了一个文件名字批处理的软件"></a>自己写了一个文件名字批处理的软件</h2><blockquote><p>网上找的都怪怪的，用起来不舒服，就自己写了一个，自由度更高，使用的是tkinter。</p></blockquote><p><strong>未来打算更新的几个功能</strong></p><ul><li><input checked="checked" disabled="disabled" type="checkbox"> 增加前缀后缀（已实现）</li><li><input checked="checked" disabled="disabled" type="checkbox"> 修改字符的半匹配（逻辑重复已pass）</li><li><input disabled="disabled" type="checkbox"> 支持正则替换</li><li><input disabled="disabled" type="checkbox"> 支持修改范围（例如：前十个）</li><li><input disabled="disabled" type="checkbox"> 支持批量word转pdf</li><li><input disabled="disabled" type="checkbox"> 支持批量pdf转word<blockquote><p> 另外附上：<a target="_blank" rel="noopener" href="https://asea.ys168.com">&gt;&gt;最新版本下载地址&lt;&lt;</a></p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import tkinter as tk</span><br><span class="line">import time</span><br><span class="line">import os</span><br><span class="line">import re</span><br><span class="line">from tkinter import scrolledtext</span><br><span class="line">import webbrowser</span><br><span class="line">import tkinter.messagebox</span><br><span class="line"></span><br><span class="line">class MY_GUI():</span><br><span class="line">    #窗口初始化</span><br><span class="line">    def __init__(self,window_name):</span><br><span class="line">        self.window &#x3D; window_name</span><br><span class="line">        self.is_all_change &#x3D; 0</span><br><span class="line">        self.is_all_change &#x3D; tk.IntVar()</span><br><span class="line">        self.can_change &#x3D; 0</span><br><span class="line">        self.theme_CN&#x3D;self.mode_CN&#x3D;&#39;默认&#39;</span><br><span class="line">        # 设置窗口</span><br><span class="line">    #窗口设置</span><br><span class="line">    def set_window(self):</span><br><span class="line">        self.window.title(&#39;文件名称批量修改器_v1.2.0&#39;)</span><br><span class="line">        self.window.geometry(&#39;800x600+500+100&#39;)</span><br><span class="line">        self.window.maxsize(800,600)</span><br><span class="line">        self.window.minsize(800,600)</span><br><span class="line">        self.window.attributes(&#39;-alpha&#39;,1) # 1为不虚化</span><br><span class="line">        # self.to_be_changed_label_name&#x3D;tk.StringVar()</span><br><span class="line">        self.to_change_label_name&#x3D;tk.StringVar()</span><br><span class="line">        self.change_button_name&#x3D;tk.StringVar()</span><br><span class="line">        # 标签</span><br><span class="line">        self.address_label &#x3D; tk.Label(self.window,text&#x3D;&#39;原文件夹的地址&#39;,font&#x3D;(&#39;microsoft yahei&#39;, 10),relief&#x3D;&#39;groove&#39;)</span><br><span class="line">        self.state_label &#x3D; tk.Label(self.window,font&#x3D;(&#39;microsoft yahei&#39;, 9),anchor&#x3D;&#39;w&#39;,relief&#x3D;&#39;groove&#39;)</span><br><span class="line">        self.to_be_changed_label &#x3D; tk.Label(self.window,text&#x3D;&#39;&#39;,font&#x3D;(&#39;microsoft yahei&#39;, 10),relief&#x3D;&#39;groove&#39;)</span><br><span class="line">        self.to_change_label &#x3D; tk.Label(self.window,text &#x3D; &#39;&#39;,font&#x3D;(&#39;microsoft yahei&#39;, 10),relief&#x3D;&#39;groove&#39;)</span><br><span class="line">        self.change_button &#x3D; tk.Button(self.window,text &#x3D; &#39;&#39;,bg&#x3D;&#39;#CCCCCC&#39;,command&#x3D;self.callChange)</span><br><span class="line">        self.original_fileList_label &#x3D; tk.Label(self.window,text&#x3D;&#39;原始文件目录&#39;,relief&#x3D;&#39;groove&#39;)</span><br><span class="line">        self.latest_fileList_label &#x3D; tk.Label(self.window,text&#x3D;&#39;修改后文件目录&#39;,relief&#x3D;&#39;groove&#39;)</span><br><span class="line">        self.log_data_label &#x3D; tk.Label(self.window,text&#x3D;&#39;工  作  日  志&#39;,font&#x3D;(&#39;microsoft yahei&#39;, 10,&#39;bold&#39;))</span><br><span class="line">        # 单行输入框</span><br><span class="line">        self.address_Entry &#x3D; tk.Entry(self.window) # 文件夹地址收集框</span><br><span class="line">        self.to_be_changed_Entry &#x3D; tk.Entry(self.window) # 要被改变的字符串</span><br><span class="line">        self.to_change_Entry &#x3D; tk.Entry(self.window) # 要改变成的字符串</span><br><span class="line">        # 按钮</span><br><span class="line">        self.is_all_change_button &#x3D; tk.Checkbutton(self.window,text &#x3D; &quot;是否遍历整个文件夹(默认为否)&quot;,variable&#x3D;self.is_all_change,onvalue&#x3D;1,offvalue&#x3D;0)</span><br><span class="line">        self.look_files_button &#x3D; tk.Button(self.window,text&#x3D;&#39;查看当前目录&#39;,command&#x3D;self.look_files)</span><br><span class="line">        self.clear_button &#x3D; tk.Button(self.window,text&#x3D;&#39;重置&#39;,command&#x3D;self.clearAll)</span><br><span class="line">        self.clearLog_button &#x3D; tk.Button(self.window,text&#x3D;&#39;清除工作日志&#39;,command&#x3D;self.clearLog)</span><br><span class="line">        # 多行文本框</span><br><span class="line">        self.original_fileList_text &#x3D; tk.Text(self.window) # 原始文件目录</span><br><span class="line">        self.latest_fileList_text &#x3D; tk.Text(self.window) # 修改后的文件目录</span><br><span class="line">        self.log_data_text &#x3D; scrolledtext.ScrolledText(self.window,font&#x3D;(&#39;microsoft yahei&#39;, 10),fg&#x3D;&#39;#fff&#39;,bg&#x3D;&#39;#455&#39;) # 工作日志</span><br><span class="line">        # 菜单栏</span><br><span class="line">        self.menubar &#x3D; tk.Menu(self.window)</span><br><span class="line">        self.func_menu &#x3D; tk.Menu(self.menubar, tearoff&#x3D;0)</span><br><span class="line">        self.menubar.add_cascade(label&#x3D;&#39;功能&#39;, menu&#x3D;self.func_menu)</span><br><span class="line">        self.func_menu.add_command(label&#x3D;&#39;查看当前目录&#39;,command&#x3D;self.look_files)</span><br><span class="line">        self.func_menu.add_command(label&#x3D;&#39;执行&#39;,command&#x3D;self.change_name)</span><br><span class="line">        self.func_menu.add_command(label&#x3D;&#39;退出&#39;,command&#x3D;self.window.quit)</span><br><span class="line">        self.func_menu.add_command(label&#x3D;&#39;重置&#39;,command&#x3D;self.clearAll)</span><br><span class="line">        self.change_mode_menu &#x3D; tk.Menu(self.menubar,tearoff&#x3D;0)</span><br><span class="line">        self.menubar.add_cascade(label&#x3D;&#39;模式&#39;,menu&#x3D;self.change_mode_menu)</span><br><span class="line">        self.change_mode_menu.add_command(label&#x3D;&#39;替换模式&#39;,command&#x3D; lambda: self.change_mode(&#39;replace_mode&#39;))</span><br><span class="line">        self.change_mode_menu.add_command(label&#x3D;&#39;加缀模式&#39;,command&#x3D;lambda: self.change_mode(&#39;clues_mode&#39;))</span><br><span class="line">        self.more_menu &#x3D; tk.Menu(self.menubar,tearoff&#x3D;0)</span><br><span class="line">        self.color_menu &#x3D; tk.Menu(self.menubar,tearoff&#x3D;0)</span><br><span class="line">        self.menubar.add_cascade(label&#x3D;&#39;主题&#39;,menu &#x3D; self.color_menu)</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;默认&#39;,command&#x3D;lambda: self.change_color(&#39;默认&#39;,&#39;#eee&#39;,&#39;#eee&#39;,&#39;#eee&#39;,&#39;#000&#39;))</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;灰蓝&#39;,command&#x3D;lambda: self.change_color(&#39;灰蓝&#39;,&#39;#758a99&#39;,&#39;#50616d&#39;,&#39;#41555d&#39;,&#39;#eee&#39;))</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;苍水&#39;,command&#x3D;lambda: self.change_color(&#39;苍水&#39;,&#39;#75878a&#39;,&#39;#88ada6&#39;,&#39;#808080&#39;,&#39;#eee&#39;))</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;茶白&#39;,command&#x3D;lambda: self.change_color(&#39;茶白&#39;,&#39;#f3f9f1&#39;,&#39;#e0eee8&#39;,&#39;#fffbf0&#39;,&#39;#000&#39;))</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;豆青&#39;,command&#x3D;lambda: self.change_color(&#39;豆青&#39;,&#39;#bce672&#39;,&#39;#96ce54&#39;,&#39;#0eb83a&#39;,&#39;#000&#39;))</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;黛紫&#39;,command&#x3D;lambda: self.change_color(&#39;豆青&#39;,&#39;#815463&#39;,&#39;#8c4356&#39;,&#39;#8c4356&#39;,&#39;#fff&#39;))</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;深黑&#39;,command&#x3D;lambda: self.change_color(&#39;深黑&#39;,&#39;#000&#39;,&#39;#000&#39;,&#39;#000&#39;,&#39;#fff&#39;))</span><br><span class="line">        self.color_menu.add_command(label&#x3D;&#39;砺茶&#39;,command&#x3D;lambda: self.change_color(&#39;砺茶&#39;,&#39;#9f6f55&#39;,&#39;#8c6450&#39;,&#39;#a16d5d&#39;,&#39;#fff&#39;))</span><br><span class="line">        self.menubar.add_cascade(label&#x3D;&#39;更多&#39;, menu&#x3D;self.more_menu)</span><br><span class="line">        self.more_menu.add_command(label&#x3D;&#39;bug反馈&#39;,command&#x3D;self.bug_return)</span><br><span class="line">        self.more_menu.add_command(label&#x3D;&#39;赞赏&#39;,command&#x3D;self.reward)</span><br><span class="line">        self.menubar.add_command(label&#x3D;&#39;关于&#39;,command&#x3D;self.about_window)</span><br><span class="line">        self.menubar.add_command(label&#x3D;&#39;更新&#39;,command&#x3D;self.update_link)</span><br><span class="line">        # 菜单栏的关联</span><br><span class="line">        self.window.config(menu&#x3D;self.menubar)</span><br><span class="line">        # 滚动条</span><br><span class="line">        self.original_fileList_text_scroll &#x3D; tk.Scrollbar()</span><br><span class="line">        self.latest_fileList_text_scroll &#x3D; tk.Scrollbar()</span><br><span class="line">        # 放到窗口的右侧, 填充Y竖直方向       </span><br><span class="line">        # 两个控件关联</span><br><span class="line">        self.original_fileList_text_scroll.config(command&#x3D;self.original_fileList_text.yview)</span><br><span class="line">        self.original_fileList_text.config(yscrollcommand&#x3D;self.original_fileList_text_scroll.set)</span><br><span class="line">        self.latest_fileList_text_scroll.config(command&#x3D;self.latest_fileList_text.yview)</span><br><span class="line">        self.latest_fileList_text.config(yscrollcommand&#x3D;self.latest_fileList_text_scroll.set)</span><br><span class="line">        self.change_mode(&#39;replace_mode&#39;)# 初始化标签名字</span><br><span class="line">        #布局</span><br><span class="line">        label_x &#x3D; 10</span><br><span class="line">        extry_x &#x3D; 140</span><br><span class="line">        fileList_text_x &#x3D; 380</span><br><span class="line">        log_text_width &#x3D; 360-label_x</span><br><span class="line">        self.address_label.place(x&#x3D;label_x,y&#x3D;0,width&#x3D;log_text_width&#x2F;3,height&#x3D;30)</span><br><span class="line">        self.to_be_changed_label.place(x&#x3D;label_x,y&#x3D;30,width&#x3D;log_text_width&#x2F;3,height&#x3D;30)</span><br><span class="line">        self.to_change_label.place(x&#x3D;label_x,y&#x3D;60,width&#x3D;log_text_width&#x2F;3,height&#x3D;30)</span><br><span class="line">        self.address_Entry.place(x&#x3D;extry_x,y&#x3D;0,width&#x3D;220,height&#x3D;30)</span><br><span class="line">        self.to_be_changed_Entry.place(x&#x3D;extry_x,y&#x3D;30,width&#x3D;220,height&#x3D;30)</span><br><span class="line">        self.to_change_Entry.place(x&#x3D;extry_x,y&#x3D;60,width&#x3D;220,height&#x3D;30)</span><br><span class="line">        self.change_button.place(x&#x3D;2*(log_text_width)&#x2F;3+label_x,y&#x3D;120,width&#x3D;log_text_width&#x2F;3,height&#x3D;30)</span><br><span class="line">        self.is_all_change_button.place(x&#x3D;100,y&#x3D;90,width&#x3D;280,height&#x3D;30)</span><br><span class="line">        self.log_data_text.place(x&#x3D;label_x,y&#x3D;175,width&#x3D;log_text_width+18,height&#x3D;430-25)</span><br><span class="line">        self.original_fileList_label.place(x&#x3D;fileList_text_x,y&#x3D;0,width&#x3D;100,height&#x3D;30)</span><br><span class="line">        self.original_fileList_text.place(x&#x3D;fileList_text_x,y&#x3D;30,width&#x3D;400,height&#x3D;250)</span><br><span class="line">        self.latest_fileList_label.place(x&#x3D;fileList_text_x,y&#x3D;300,width&#x3D;100,height&#x3D;30)</span><br><span class="line">        self.latest_fileList_text.place(x&#x3D;fileList_text_x,y&#x3D;330,width&#x3D;400,height&#x3D;250)</span><br><span class="line">        self.look_files_button.place(x&#x3D;label_x,y&#x3D;90,width&#x3D;log_text_width&#x2F;3,height&#x3D;30)</span><br><span class="line">        self.clear_button.place(x&#x3D;label_x,y&#x3D;120,width&#x3D;log_text_width&#x2F;3,height&#x3D;30)</span><br><span class="line">        self.original_fileList_text_scroll.place(x&#x3D;780,y&#x3D;0,width&#x3D;15,height&#x3D;300)</span><br><span class="line">        self.latest_fileList_text_scroll.place(x&#x3D;780,y&#x3D;330,width&#x3D;15,height&#x3D;300)</span><br><span class="line">        self.clearLog_button.place(x&#x3D;log_text_width&#x2F;3+label_x,y&#x3D;120,width&#x3D;log_text_width&#x2F;3,height&#x3D;30)</span><br><span class="line">        self.log_data_label.place(x&#x3D;label_x,y&#x3D;150,width&#x3D;log_text_width,height&#x3D;25)</span><br><span class="line">        self.state_label.place(x&#x3D;label_x,y&#x3D;580,width&#x3D;log_text_width,height&#x3D;20)</span><br><span class="line">    def change_color(self,theme_CN,color1,color2,color3,fontcolor):</span><br><span class="line">        self.address_label.config(bg&#x3D;color1,fg&#x3D;fontcolor)</span><br><span class="line">        self.to_be_changed_label.config(bg&#x3D;color2,fg&#x3D;fontcolor)</span><br><span class="line">        self.to_change_label.config(bg&#x3D;color3,fg&#x3D;fontcolor)</span><br><span class="line">        self.original_fileList_label.config(bg &#x3D; color1,fg&#x3D;fontcolor)</span><br><span class="line">        self.latest_fileList_label.config(bg&#x3D;color1,fg&#x3D;fontcolor)</span><br><span class="line">        self.log_data_label.config(bg&#x3D;color2,fg&#x3D;fontcolor)</span><br><span class="line">        self.theme_CN&#x3D;theme_CN</span><br><span class="line">        self.state_label.config(text&#x3D;&#39;当前模式：&#39;+self.mode_CN+&#39;       当前主题：&#39;+self.theme_CN)</span><br><span class="line">    def change_mode(self,mode):</span><br><span class="line">        if mode &#x3D;&#x3D; &#39;replace_mode&#39;:</span><br><span class="line">            self.mode&#x3D;&#39;replace_mode&#39;</span><br><span class="line">            self.to_be_changed_label.config(text &#x3D; &#39;被替换的字符串&#39;)</span><br><span class="line">            self.to_change_label.config(text &#x3D; &#39;来替换的字符串&#39;)</span><br><span class="line">            self.change_button.config(text &#x3D; &#39;替换&#39;)</span><br><span class="line">            self.mode_CN&#x3D;&#39;替换模式&#39;</span><br><span class="line">        else:</span><br><span class="line">            self.mode&#x3D;&#39;clues_mode&#39;</span><br><span class="line">            self.to_be_changed_label.config(text&#x3D;&#39;要添加的前缀&#39;)</span><br><span class="line">            self.to_change_label.config(text &#x3D; &#39;要添加的后缀&#39;)</span><br><span class="line">            self.change_button.config(text &#x3D; &#39;添加&#39;)</span><br><span class="line">            self.mode_CN&#x3D;&#39;加缀模式&#39;</span><br><span class="line">        self.state_label.config(text&#x3D;&#39;当前模式：&#39;+self.mode_CN+&#39;        当前主题：&#39;+self.theme_CN)</span><br><span class="line">    def update_link(self):</span><br><span class="line">        webbrowser.open(&#39;http:&#x2F;&#x2F;asea.ys168.com&#x2F;&#39;,new&#x3D;0)</span><br><span class="line">    def reward(self):</span><br><span class="line">        webbrowser.open(&quot;https:&#x2F;&#x2F;img.imgdb.cn&#x2F;item&#x2F;605ff1f08322e6675cb51721.jpg&quot;, new&#x3D;0)</span><br><span class="line">    def about_window(self):</span><br><span class="line">        tk.messagebox.askyesno(&#39;关于&#39;,&#39;本软件为我闲暇之余开发的小应用，目的是解决一下自己常遇到的批量替换文件名的问题，由于我还是个新手，软件可能还有bug，你可以点击菜单栏的更多——bug反馈来进行反馈，希望本工具能够帮助到你。&#39;)</span><br><span class="line">    def bug_return(self):</span><br><span class="line">        webbrowser.open(&quot;tencent:&#x2F;&#x2F;message&#x2F;?uin&#x3D;569389750&amp;Site&#x3D;admin5.com&amp;Menu&#x3D;yes&quot;, new&#x3D;0)</span><br><span class="line">    #清除工作日志</span><br><span class="line">    def clearLog(self):</span><br><span class="line">        self.log_data_text.delete(1.0,tk.END)</span><br><span class="line">        current_time &#x3D; str(self.get_current_time())</span><br><span class="line">        self.log_data_text.insert(1.0, current_time+&#39; &#39;+&#39;WARNING:已清除\n&#39;)</span><br><span class="line">        # self.log_data_text.mark_set(&#39;insert&#39;, tk.END)</span><br><span class="line">    #遍历文件夹返回生成器</span><br><span class="line">    def findAllFile(self,path): # 获取文件夹下所有文件</span><br><span class="line">        for root, ds, fs in os.walk(path):</span><br><span class="line">            for f in fs:</span><br><span class="line">                fullname &#x3D; [os.path.join(root, f),os.path.join(root),os.path.join(f)]</span><br><span class="line">                yield fullname</span><br><span class="line">    #重置</span><br><span class="line">    def clearAll(self):</span><br><span class="line">        current_time &#x3D; str(self.get_current_time())</span><br><span class="line">        # self.address_Entry.delete(0,tk.END)</span><br><span class="line">        # self.to_be_changed_Entry.delete(0,tk.END)</span><br><span class="line">        # self.to_change_Entry.delete(0,tk.END,)</span><br><span class="line">        # self.log_data_text.delete(1.0,tk.END)</span><br><span class="line">        self.set_window()</span><br><span class="line">        self.log_data_text.insert(1.0,current_time+&#39; &#39;+&#39;WARNING:已重置\n&#39;)</span><br><span class="line">        # self.original_fileList_text.delete(1.0,tk.END)</span><br><span class="line">        # self.latest_fileList_text.delete(1.0,tk.END)</span><br><span class="line">    #获取当前时间</span><br><span class="line">    def get_current_time(self):</span><br><span class="line">        current_time &#x3D; time.strftime(&#39;%Y-%m-%d %H:%M:%S&#39;,time.localtime(time.time()))</span><br><span class="line">        return current_time</span><br><span class="line">    #判断是否输入文件夹地址</span><br><span class="line">    def callChange(self):</span><br><span class="line">        if self.address_Entry.get() !&#x3D; &#39;&#39;:</span><br><span class="line">            self.change_name()</span><br><span class="line">    #查看当前文件夹目录</span><br><span class="line">    def look_files(self):</span><br><span class="line">        self.original_fileList_text.delete(1.0,tk.END)</span><br><span class="line">        address_str &#x3D; self.address_Entry.get()</span><br><span class="line">        try:</span><br><span class="line">            if self.is_all_change.get():</span><br><span class="line">                fileList &#x3D; self.findAllFile(address_str)</span><br><span class="line">                for filelist in fileList:</span><br><span class="line">                    self.original_fileList_text.insert(tk.END,filelist[2]+&#39;\n&#39;)</span><br><span class="line">            else:</span><br><span class="line">                fileList &#x3D; os.listdir(address_str)</span><br><span class="line">                for fileName in fileList:</span><br><span class="line">                    self.original_fileList_text.insert(tk.END,fileName+&#39;\n&#39;)</span><br><span class="line">        except:</span><br><span class="line">            current_time &#x3D; self.get_current_time()</span><br><span class="line">            self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;ERROR:请确认路径存在\n&#39;)</span><br><span class="line"></span><br><span class="line">    #主函数</span><br><span class="line">    def change_name(self):</span><br><span class="line">        address_str &#x3D; self.address_Entry.get()</span><br><span class="line">        if self.is_all_change.get():#判断是否遍历</span><br><span class="line">            current_time &#x3D; self.get_current_time()</span><br><span class="line">            try:</span><br><span class="line">                fileList &#x3D; self.findAllFile(address_str)</span><br><span class="line">            except:</span><br><span class="line">                self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;ERROR:请确认路径存在\n&#39;)</span><br><span class="line">            self.original_fileList_text.delete(1.0,tk.END)</span><br><span class="line">            self.latest_fileList_text.delete(1.0,tk.END)</span><br><span class="line">            to_be_changed_str &#x3D; self.to_be_changed_Entry.get()</span><br><span class="line">            to_change_str &#x3D; self.to_change_Entry.get()</span><br><span class="line">            num &#x3D; 0</span><br><span class="line">            for filelist in (fileList):</span><br><span class="line">                fileName &#x3D; filelist[0]#绝对路径</span><br><span class="line">                fileRoot &#x3D; filelist[1]+&#39;\\&#39;</span><br><span class="line">                fileShortName &#x3D; filelist[2]</span><br><span class="line">                self.original_fileList_text.insert(tk.END,fileShortName+&#39;\n&#39;)</span><br><span class="line">                if self.mode &#x3D;&#x3D; &#39;replace_mode&#39;:</span><br><span class="line">                    try:</span><br><span class="line">                        os.rename(fileName, fileRoot + fileShortName.replace(to_be_changed_str,to_change_str)) # 文件重新命名</span><br><span class="line">                        if fileShortName !&#x3D; fileShortName.replace(to_be_changed_str,to_change_str):</span><br><span class="line">                            num +&#x3D; 1</span><br><span class="line">                            self.log_data_text.insert(tk.END, &#39;已将\n&#39;+fileShortName+&#39;\n&#39;+&#39;修改为\n&#39;+fileShortName.replace(to_be_changed_str,to_change_str)+&#39;\n&#39;+&#39;-&#39;*20+&#39;\n&#39;)</span><br><span class="line">                    except:</span><br><span class="line">                        self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;ERROR:无法同时存在两个相同名字的文件\n&#39;)</span><br><span class="line">                else:</span><br><span class="line">                    try:</span><br><span class="line">                        os.rename(fileName, fileRoot + to_be_changed_str + os.path.splitext(fileShortName)[0] + to_change_str + os.path.splitext(fileShortName)[1]) </span><br><span class="line">                        num +&#x3D; 1</span><br><span class="line">                        self.log_data_text.insert(tk.END, &#39;已将\n&#39;+fileName+&#39;\n&#39;+&#39;修改为\n&#39;+fileRoot + fileShortName.replace(to_be_changed_str,to_change_str)+&#39;\n&#39;+&#39;-&#39;*20+&#39;\n&#39;)</span><br><span class="line">                    except:</span><br><span class="line">                        self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;ERROR:添加错误，请点击菜单栏反馈bug\n&#39;)</span><br><span class="line">            self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;共修改&#39;+str(num)+&#39;个文件&#39;+&#39;\n&#39;+&#39;&#123;:■^26&#125;&#39;.format(&#39;本次修改结束&#39;)+&#39;\n&#39;)</span><br><span class="line">            fileList &#x3D; self.findAllFile(address_str)</span><br><span class="line">            for filelist in fileList:</span><br><span class="line">                self.latest_fileList_text.insert(tk.END,filelist[2]+&#39;\n&#39;)</span><br><span class="line">            self.log_data_text.see(tk.END) # 自动将光标移到末尾</span><br><span class="line">        else:</span><br><span class="line">            current_time &#x3D; self.get_current_time()</span><br><span class="line">            try:</span><br><span class="line">                fileList &#x3D; os.listdir(address_str)</span><br><span class="line">            except:</span><br><span class="line">                self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;ERROR:请确认路径存在\n&#39;)</span><br><span class="line">            # os.chdir(address_str)  # 将当前工作目录修改为待修改文件夹的位置</span><br><span class="line">            self.original_fileList_text.delete(1.0,tk.END)</span><br><span class="line">            self.latest_fileList_text.delete(1.0,tk.END)</span><br><span class="line">            to_be_changed_str &#x3D; self.to_be_changed_Entry.get()</span><br><span class="line">            to_change_str &#x3D; self.to_change_Entry.get()</span><br><span class="line">            num &#x3D; 0</span><br><span class="line">            for fileName in fileList:</span><br><span class="line">                self.original_fileList_text.insert(tk.END,fileName+&#39;\n&#39;)</span><br><span class="line">                if self.mode &#x3D;&#x3D; &#39;replace_mode&#39;:</span><br><span class="line">                    try:</span><br><span class="line">                        os.rename(address_str+&#39;\\&#39;+fileName, address_str+&#39;\\&#39;+fileName.replace(to_be_changed_str,to_change_str)) # 3. 文件重新命名 规则根据需求自己定</span><br><span class="line">                        if fileName !&#x3D; fileName.replace(to_be_changed_str,to_change_str):</span><br><span class="line">                            num +&#x3D; 1</span><br><span class="line">                            self.log_data_text.insert(tk.END, &#39;已将\n&#39;+fileName+&#39;\n&#39;+&#39;修改为\n&#39;+fileName.replace(to_be_changed_str,to_change_str)+&#39;\n&#39;+&#39;-&#39;*20+&#39;\n&#39;)</span><br><span class="line">                    except:</span><br><span class="line">                        self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;ERROR:无法同时存在两个相同名字的文件\n&#39;)</span><br><span class="line">                else:</span><br><span class="line">                    try:</span><br><span class="line">                        os.rename(address_str+&#39;\\&#39;+fileName, address_str+&#39;\\&#39;+to_be_changed_str+os.path.splitext(fileName)[0]+to_change_str+os.path.splitext(fileName)[1]) # 3. 文件重新命名 规则根据需求自己定</span><br><span class="line">                        num +&#x3D; 1</span><br><span class="line">                        self.log_data_text.insert(tk.END, &#39;已将\n&#39;+fileName+&#39;\n&#39;+&#39;修改为\n&#39;+fileName.replace(to_be_changed_str,to_change_str)+&#39;\n&#39;+&#39;-&#39;*20+&#39;\n&#39;)</span><br><span class="line">                    except:</span><br><span class="line">                        self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;ERROR:添加错误，请点击菜单栏反馈bug\n&#39;)</span><br><span class="line">            fileList &#x3D; os.listdir(address_str)</span><br><span class="line">            self.latest_fileList_text.insert(tk.END,&#39;\n&#39;.join(fileList))</span><br><span class="line">            self.log_data_text.insert(tk.END,current_time+&#39; &#39;+&#39;共修改&#39;+str(num)+&#39;个文件&#39;+&#39;\n&#39;+&#39;&#123;:■^26&#125;&#39;.format(&#39;本次修改结束&#39;)+&#39;\n&#39;)</span><br><span class="line">            self.log_data_text.see(tk.END)</span><br><span class="line"></span><br><span class="line">def gui_start():</span><br><span class="line">    window &#x3D; tk.Tk()</span><br><span class="line">    MY_PORTAL &#x3D; MY_GUI(window)</span><br><span class="line">    MY_PORTAL.set_window()</span><br><span class="line">    window.mainloop()</span><br><span class="line"></span><br><span class="line">gui_start()#启动</span><br></pre></td></tr></table></figure><h2 id="pyinstaller反编译代码《pyinstxtractor-py》"><a href="#pyinstaller反编译代码《pyinstxtractor-py》" class="headerlink" title="pyinstaller反编译代码《pyinstxtractor.py》"></a>pyinstaller反编译代码《pyinstxtractor.py》</h2><blockquote><p>具体使用可以自行百度<strong>pyinstxtractor.py</strong></p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">PyInstaller Extractor v1.9 (Supports pyinstaller 3.3, 3.2, 3.1, 3.0, 2.1, 2.0)</span><br><span class="line">Author : Extreme Coders</span><br><span class="line">E-mail : extremecoders(at)hotmail(dot)com</span><br><span class="line">Web    : https:&#x2F;&#x2F;0xec.blogspot.com</span><br><span class="line">Date   : 29-November-2017</span><br><span class="line">Url    : https:&#x2F;&#x2F;sourceforge.net&#x2F;projects&#x2F;pyinstallerextractor&#x2F;</span><br><span class="line"></span><br><span class="line">For any suggestions, leave a comment on</span><br><span class="line">https:&#x2F;&#x2F;forum.tuts4you.com&#x2F;topic&#x2F;34455-pyinstaller-extractor&#x2F;</span><br><span class="line"></span><br><span class="line">This script extracts a pyinstaller generated executable file.</span><br><span class="line">Pyinstaller installation is not needed. The script has it all.</span><br><span class="line"></span><br><span class="line">For best results, it is recommended to run this script in the</span><br><span class="line">same version of python as was used to create the executable.</span><br><span class="line">This is just to prevent unmarshalling errors(if any) while</span><br><span class="line">extracting the PYZ archive.</span><br><span class="line"></span><br><span class="line">Usage : Just copy this script to the directory where your exe resides</span><br><span class="line">        and run the script with the exe file name as a parameter</span><br><span class="line"></span><br><span class="line">C:\path\to\exe\&gt;python pyinstxtractor.py &lt;filename&gt;</span><br><span class="line">$ &#x2F;path&#x2F;to&#x2F;exe&#x2F;python pyinstxtractor.py &lt;filename&gt;</span><br><span class="line"></span><br><span class="line">Licensed under GNU General Public License (GPL) v3.</span><br><span class="line">You are free to modify this source.</span><br><span class="line"></span><br><span class="line">CHANGELOG</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Version 1.1 (Jan 28, 2014)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- First Release</span><br><span class="line">- Supports only pyinstaller 2.0</span><br><span class="line"></span><br><span class="line">Version 1.2 (Sept 12, 2015)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Added support for pyinstaller 2.1 and 3.0 dev</span><br><span class="line">- Cleaned up code</span><br><span class="line">- Script is now more verbose</span><br><span class="line">- Executable extracted within a dedicated sub-directory</span><br><span class="line"></span><br><span class="line">(Support for pyinstaller 3.0 dev is experimental)</span><br><span class="line"></span><br><span class="line">Version 1.3 (Dec 12, 2015)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Added support for pyinstaller 3.0 final</span><br><span class="line">- Script is compatible with both python 2.x &amp; 3.x (Thanks to Moritz Kroll @ Avira Operations GmbH &amp; Co. KG)</span><br><span class="line"></span><br><span class="line">Version 1.4 (Jan 19, 2016)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Fixed a bug when writing pyc files &gt;&#x3D; version 3.3 (Thanks to Daniello Alto: https:&#x2F;&#x2F;github.com&#x2F;Djamana)</span><br><span class="line"></span><br><span class="line">Version 1.5 (March 1, 2016)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Added support for pyinstaller 3.1 (Thanks to Berwyn Hoyt for reporting)</span><br><span class="line"></span><br><span class="line">Version 1.6 (Sept 5, 2016)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Added support for pyinstaller 3.2</span><br><span class="line">- Extractor will use a random name while extracting unnamed files.</span><br><span class="line">- For encrypted pyz archives it will dump the contents as is. Previously, the tool would fail.</span><br><span class="line"></span><br><span class="line">Version 1.7 (March 13, 2017)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Made the script compatible with python 2.6 (Thanks to Ross for reporting)</span><br><span class="line"></span><br><span class="line">Version 1.8 (April 28, 2017)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Support for sub-directories in .pyz files (Thanks to Moritz Kroll @ Avira Operations GmbH &amp; Co. KG)</span><br><span class="line"></span><br><span class="line">Version 1.9 (November 29, 2017)</span><br><span class="line">-------------------------------------------------</span><br><span class="line">- Added support for pyinstaller 3.3</span><br><span class="line">- Display the scripts which are run at entry (Thanks to Michael Gillespie @ malwarehunterteam for the feature request)</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">from __future__ import print_function</span><br><span class="line">import os</span><br><span class="line">import struct</span><br><span class="line">import marshal</span><br><span class="line">import zlib</span><br><span class="line">import sys</span><br><span class="line">import imp</span><br><span class="line">import types</span><br><span class="line">from uuid import uuid4 as uniquename</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class CTOCEntry:</span><br><span class="line">    def __init__(self, position, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name):</span><br><span class="line">        self.position &#x3D; position</span><br><span class="line">        self.cmprsdDataSize &#x3D; cmprsdDataSize</span><br><span class="line">        self.uncmprsdDataSize &#x3D; uncmprsdDataSize</span><br><span class="line">        self.cmprsFlag &#x3D; cmprsFlag</span><br><span class="line">        self.typeCmprsData &#x3D; typeCmprsData</span><br><span class="line">        self.name &#x3D; name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class PyInstArchive:</span><br><span class="line">    PYINST20_COOKIE_SIZE &#x3D; 24           # For pyinstaller 2.0</span><br><span class="line">    PYINST21_COOKIE_SIZE &#x3D; 24 + 64      # For pyinstaller 2.1+</span><br><span class="line">    MAGIC &#x3D; b&#39;MEI\014\013\012\013\016&#39;  # Magic number which identifies pyinstaller</span><br><span class="line"></span><br><span class="line">    def __init__(self, path):</span><br><span class="line">        self.filePath &#x3D; path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def open(self):</span><br><span class="line">        try:</span><br><span class="line">            self.fPtr &#x3D; open(self.filePath, &#39;rb&#39;)</span><br><span class="line">            self.fileSize &#x3D; os.stat(self.filePath).st_size</span><br><span class="line">        except:</span><br><span class="line">            print(&#39;[*] Error: Could not open &#123;0&#125;&#39;.format(self.filePath))</span><br><span class="line">            return False</span><br><span class="line">        return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def close(self):</span><br><span class="line">        try:</span><br><span class="line">            self.fPtr.close()</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def checkFile(self):</span><br><span class="line">        print(&#39;[*] Processing &#123;0&#125;&#39;.format(self.filePath))</span><br><span class="line">        # Check if it is a 2.0 archive</span><br><span class="line">        self.fPtr.seek(self.fileSize - self.PYINST20_COOKIE_SIZE, os.SEEK_SET)</span><br><span class="line">        magicFromFile &#x3D; self.fPtr.read(len(self.MAGIC))</span><br><span class="line"></span><br><span class="line">        if magicFromFile &#x3D;&#x3D; self.MAGIC:</span><br><span class="line">            self.pyinstVer &#x3D; 20     # pyinstaller 2.0</span><br><span class="line">            print(&#39;[*] Pyinstaller version: 2.0&#39;)</span><br><span class="line">            return True</span><br><span class="line"></span><br><span class="line">        # Check for pyinstaller 2.1+ before bailing out</span><br><span class="line">        self.fPtr.seek(self.fileSize - self.PYINST21_COOKIE_SIZE, os.SEEK_SET)</span><br><span class="line">        magicFromFile &#x3D; self.fPtr.read(len(self.MAGIC))</span><br><span class="line"></span><br><span class="line">        if magicFromFile &#x3D;&#x3D; self.MAGIC:</span><br><span class="line">            print(&#39;[*] Pyinstaller version: 2.1+&#39;)</span><br><span class="line">            self.pyinstVer &#x3D; 21     # pyinstaller 2.1+</span><br><span class="line">            return True</span><br><span class="line"></span><br><span class="line">        print(&#39;[*] Error : Unsupported pyinstaller version or not a pyinstaller archive&#39;)</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def getCArchiveInfo(self):</span><br><span class="line">        try:</span><br><span class="line">            if self.pyinstVer &#x3D;&#x3D; 20:</span><br><span class="line">                self.fPtr.seek(self.fileSize - self.PYINST20_COOKIE_SIZE, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">                # Read CArchive cookie</span><br><span class="line">                (magic, lengthofPackage, toc, tocLen, self.pyver) &#x3D; \</span><br><span class="line">                struct.unpack(&#39;!8siiii&#39;, self.fPtr.read(self.PYINST20_COOKIE_SIZE))</span><br><span class="line"></span><br><span class="line">            elif self.pyinstVer &#x3D;&#x3D; 21:</span><br><span class="line">                self.fPtr.seek(self.fileSize - self.PYINST21_COOKIE_SIZE, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">                # Read CArchive cookie</span><br><span class="line">                (magic, lengthofPackage, toc, tocLen, self.pyver, pylibname) &#x3D; \</span><br><span class="line">                struct.unpack(&#39;!8siiii64s&#39;, self.fPtr.read(self.PYINST21_COOKIE_SIZE))</span><br><span class="line"></span><br><span class="line">        except:</span><br><span class="line">            print(&#39;[*] Error : The file is not a pyinstaller archive&#39;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">        print(&#39;[*] Python version: &#123;0&#125;&#39;.format(self.pyver))</span><br><span class="line"></span><br><span class="line">        # Overlay is the data appended at the end of the PE</span><br><span class="line">        self.overlaySize &#x3D; lengthofPackage</span><br><span class="line">        self.overlayPos &#x3D; self.fileSize - self.overlaySize</span><br><span class="line">        self.tableOfContentsPos &#x3D; self.overlayPos + toc</span><br><span class="line">        self.tableOfContentsSize &#x3D; tocLen</span><br><span class="line"></span><br><span class="line">        print(&#39;[*] Length of package: &#123;0&#125; bytes&#39;.format(self.overlaySize))</span><br><span class="line">        return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def parseTOC(self):</span><br><span class="line">        # Go to the table of contents</span><br><span class="line">        self.fPtr.seek(self.tableOfContentsPos, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">        self.tocList &#x3D; []</span><br><span class="line">        parsedLen &#x3D; 0</span><br><span class="line"></span><br><span class="line">        # Parse table of contents</span><br><span class="line">        while parsedLen &lt; self.tableOfContentsSize:</span><br><span class="line">            (entrySize, ) &#x3D; struct.unpack(&#39;!i&#39;, self.fPtr.read(4))</span><br><span class="line">            nameLen &#x3D; struct.calcsize(&#39;!iiiiBc&#39;)</span><br><span class="line"></span><br><span class="line">            (entryPos, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name) &#x3D; \</span><br><span class="line">            struct.unpack( \</span><br><span class="line">                &#39;!iiiBc&#123;0&#125;s&#39;.format(entrySize - nameLen), \</span><br><span class="line">                self.fPtr.read(entrySize - 4))</span><br><span class="line"></span><br><span class="line">            name &#x3D; name.decode(&#39;utf-8&#39;).rstrip(&#39;\0&#39;)</span><br><span class="line">            if len(name) &#x3D;&#x3D; 0:</span><br><span class="line">                name &#x3D; str(uniquename())</span><br><span class="line">                print(&#39;[!] Warning: Found an unamed file in CArchive. Using random name &#123;0&#125;&#39;.format(name))</span><br><span class="line"></span><br><span class="line">            self.tocList.append( \</span><br><span class="line">                                CTOCEntry(                      \</span><br><span class="line">                                    self.overlayPos + entryPos, \</span><br><span class="line">                                    cmprsdDataSize,             \</span><br><span class="line">                                    uncmprsdDataSize,           \</span><br><span class="line">                                    cmprsFlag,                  \</span><br><span class="line">                                    typeCmprsData,              \</span><br><span class="line">                                    name                        \</span><br><span class="line">                                ))</span><br><span class="line"></span><br><span class="line">            parsedLen +&#x3D; entrySize</span><br><span class="line">        print(&#39;[*] Found &#123;0&#125; files in CArchive&#39;.format(len(self.tocList)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def extractFiles(self):</span><br><span class="line">        print(&#39;[*] Beginning extraction...please standby&#39;)</span><br><span class="line">        extractionDir &#x3D; os.path.join(os.getcwd(), os.path.basename(self.filePath) + &#39;_extracted&#39;)</span><br><span class="line"></span><br><span class="line">        if not os.path.exists(extractionDir):</span><br><span class="line">            os.mkdir(extractionDir)</span><br><span class="line"></span><br><span class="line">        os.chdir(extractionDir)</span><br><span class="line"></span><br><span class="line">        for entry in self.tocList:</span><br><span class="line">            basePath &#x3D; os.path.dirname(entry.name)</span><br><span class="line">            if basePath !&#x3D; &#39;&#39;:</span><br><span class="line">                # Check if path exists, create if not</span><br><span class="line">                if not os.path.exists(basePath):</span><br><span class="line">                    os.makedirs(basePath)</span><br><span class="line"></span><br><span class="line">            self.fPtr.seek(entry.position, os.SEEK_SET)</span><br><span class="line">            data &#x3D; self.fPtr.read(entry.cmprsdDataSize)</span><br><span class="line"></span><br><span class="line">            if entry.cmprsFlag &#x3D;&#x3D; 1:</span><br><span class="line">                data &#x3D; zlib.decompress(data)</span><br><span class="line">                # Malware may tamper with the uncompressed size</span><br><span class="line">                # Comment out the assertion in such a case</span><br><span class="line">                assert len(data) &#x3D;&#x3D; entry.uncmprsdDataSize # Sanity Check</span><br><span class="line"></span><br><span class="line">            with open(entry.name, &#39;wb&#39;) as f:</span><br><span class="line">                f.write(data)</span><br><span class="line"></span><br><span class="line">            if entry.typeCmprsData &#x3D;&#x3D; b&#39;s&#39;:</span><br><span class="line">            	print(&#39;[+] Possible entry point: &#123;0&#125;&#39;.format(entry.name))</span><br><span class="line"></span><br><span class="line">            elif entry.typeCmprsData &#x3D;&#x3D; b&#39;z&#39; or entry.typeCmprsData &#x3D;&#x3D; b&#39;Z&#39;:</span><br><span class="line">                self._extractPyz(entry.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def _extractPyz(self, name):</span><br><span class="line">        dirName &#x3D;  name + &#39;_extracted&#39;</span><br><span class="line">        # Create a directory for the contents of the pyz</span><br><span class="line">        if not os.path.exists(dirName):</span><br><span class="line">            os.mkdir(dirName)</span><br><span class="line"></span><br><span class="line">        with open(name, &#39;rb&#39;) as f:</span><br><span class="line">            pyzMagic &#x3D; f.read(4)</span><br><span class="line">            assert pyzMagic &#x3D;&#x3D; b&#39;PYZ\0&#39; # Sanity Check</span><br><span class="line"></span><br><span class="line">            pycHeader &#x3D; f.read(4) # Python magic value</span><br><span class="line"></span><br><span class="line">            if imp.get_magic() !&#x3D; pycHeader:</span><br><span class="line">                print(&#39;[!] Warning: The script is running in a different python version than the one used to build the executable&#39;)</span><br><span class="line">                print(&#39;    Run this script in Python&#123;0&#125; to prevent extraction errors(if any) during unmarshalling&#39;.format(self.pyver))</span><br><span class="line"></span><br><span class="line">            (tocPosition, ) &#x3D; struct.unpack(&#39;!i&#39;, f.read(4))</span><br><span class="line">            f.seek(tocPosition, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">            try:</span><br><span class="line">                toc &#x3D; marshal.load(f)</span><br><span class="line">            except:</span><br><span class="line">                print(&#39;[!] Unmarshalling FAILED. Cannot extract &#123;0&#125;. Extracting remaining files.&#39;.format(name))</span><br><span class="line">                return</span><br><span class="line"></span><br><span class="line">            print(&#39;[*] Found &#123;0&#125; files in PYZ archive&#39;.format(len(toc)))</span><br><span class="line"></span><br><span class="line">            # From pyinstaller 3.1+ toc is a list of tuples</span><br><span class="line">            if type(toc) &#x3D;&#x3D; list:</span><br><span class="line">                toc &#x3D; dict(toc)</span><br><span class="line"></span><br><span class="line">            for key in toc.keys():</span><br><span class="line">                (ispkg, pos, length) &#x3D; toc[key]</span><br><span class="line">                f.seek(pos, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">                fileName &#x3D; key</span><br><span class="line">                try:</span><br><span class="line">                    # for Python &gt; 3.3 some keys are bytes object some are str object</span><br><span class="line">                    fileName &#x3D; key.decode(&#39;utf-8&#39;)</span><br><span class="line">                except:</span><br><span class="line">                    pass</span><br><span class="line"></span><br><span class="line">                # Make sure destination directory exists, ensuring we keep inside dirName</span><br><span class="line">                destName &#x3D; os.path.join(dirName, fileName.replace(&quot;..&quot;, &quot;__&quot;))</span><br><span class="line">                destDirName &#x3D; os.path.dirname(destName)</span><br><span class="line">                if not os.path.exists(destDirName):</span><br><span class="line">                    os.makedirs(destDirName)</span><br><span class="line"></span><br><span class="line">                try:</span><br><span class="line">                    data &#x3D; f.read(length)</span><br><span class="line">                    data &#x3D; zlib.decompress(data)</span><br><span class="line">                except:</span><br><span class="line">                    print(&#39;[!] Error: Failed to decompress &#123;0&#125;, probably encrypted. Extracting as is.&#39;.format(fileName))</span><br><span class="line">                    open(destName + &#39;.pyc.encrypted&#39;, &#39;wb&#39;).write(data)</span><br><span class="line">                    continue</span><br><span class="line"></span><br><span class="line">                with open(destName + &#39;.pyc&#39;, &#39;wb&#39;) as pycFile:</span><br><span class="line">                    pycFile.write(pycHeader)      # Write pyc magic</span><br><span class="line">                    pycFile.write(b&#39;\0&#39; * 4)      # Write timestamp</span><br><span class="line">                    if self.pyver &gt;&#x3D; 33:</span><br><span class="line">                        pycFile.write(b&#39;\0&#39; * 4)  # Size parameter added in Python 3.3</span><br><span class="line">                    pycFile.write(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    if len(sys.argv) &lt; 2:</span><br><span class="line">        print(&#39;[*] Usage: pyinstxtractor.py &lt;filename&gt;&#39;)</span><br><span class="line"></span><br><span class="line">    else:</span><br><span class="line">        arch &#x3D; PyInstArchive(sys.argv[1])</span><br><span class="line">        if arch.open():</span><br><span class="line">            if arch.checkFile():</span><br><span class="line">                if arch.getCArchiveInfo():</span><br><span class="line">                    arch.parseTOC()</span><br><span class="line">                    arch.extractFiles()</span><br><span class="line">                    arch.close()</span><br><span class="line">                    print(&#39;[*] Successfully extracted pyinstaller archive: &#123;0&#125;&#39;.format(sys.argv[1]))</span><br><span class="line">                    print(&#39;&#39;)</span><br><span class="line">                    print(&#39;You can now use a python decompiler on the pyc files within the extracted directory&#39;)</span><br><span class="line">                    return</span><br><span class="line"></span><br><span class="line">            arch.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="预支项目"><a href="#预支项目" class="headerlink" title="预支项目"></a>预支项目</h1><h2 id="opencv"><a href="#opencv" class="headerlink" title="opencv"></a>opencv</h2><h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><h2 id="pdf-word"><a href="#pdf-word" class="headerlink" title="pdf-word"></a>pdf-word</h2><h2 id="mysql-python搭建后端接口"><a href="#mysql-python搭建后端接口" class="headerlink" title="mysql+python搭建后端接口"></a>mysql+python搭建后端接口</h2></li></ul></div><div class="reward-container"><div></div> <button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'> b(￣▽￣)d</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="/images/wechat.png" alt="Asea 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="/images/alipay.png" alt="Asea 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> Asea</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://asea.fun/post/71485f5b.html" title="python项目练习">https://asea.fun/post/71485f5b.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>\(@^0^@)/</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="https://www.zhihu.com/people/michael-48-84-31"><span class="icon"><i class="fab fa-zhihu"></i></span> <span class="label">知乎</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://weibo.com/5568238770/profile?rightmod=1&wvr=6&mod=personinfo"><span class="icon"><i class="fab fa-weibo"></i></span> <span class="label">微博</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="https://blog.asea.fun"><span class="icon"><i class="fa fa-user"></i></span> <span class="label">另一个博客</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a></div><div class="post-nav"><div class="post-nav-item"><a href="/post/afab6017.html" rel="prev" title="three.js学习笔记"><i class="fa fa-chevron-left"></i> three.js学习笔记</a></div><div class="post-nav-item"> <a href="/post/f32b1748.html" rel="next" title="看小米春季新品发布会有感">看小米春季新品发布会有感<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Bpython%E5%B8%B8%E7%94%A8%E7%9A%84%E6%BA%90%E7%A0%81"><span class="nav-number">1.</span> <span class="nav-text">记录一下python常用的源码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1"><span class="nav-number">1.1.</span> <span class="nav-text">邮件服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E6%9B%B4%E6%96%B0%E6%97%B6%E9%97%B4"><span class="nav-number">1.2.</span> <span class="nav-text">自动更新更新时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%B7%B1%E5%86%99%E4%BA%86%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%90%8D%E5%AD%97%E6%89%B9%E5%A4%84%E7%90%86%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="nav-number">1.3.</span> <span class="nav-text">自己写了一个文件名字批处理的软件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pyinstaller%E5%8F%8D%E7%BC%96%E8%AF%91%E4%BB%A3%E7%A0%81%E3%80%8Apyinstxtractor-py%E3%80%8B"><span class="nav-number">1.4.</span> <span class="nav-text">pyinstaller反编译代码《pyinstxtractor.py》</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A2%84%E6%94%AF%E9%A1%B9%E7%9B%AE"><span class="nav-number">2.</span> <span class="nav-text">预支项目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#opencv"><span class="nav-number">2.1.</span> <span class="nav-text">opencv</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="nav-number">2.2.</span> <span class="nav-text">可视化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pdf-word"><span class="nav-number">2.3.</span> <span class="nav-text">pdf-word</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql-python%E6%90%AD%E5%BB%BA%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3"><span class="nav-number">2.4.</span> <span class="nav-text">mysql+python搭建后端接口</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Asea" src="/images/avatar1.png"><p class="site-author-name" itemprop="name">Asea</p><div class="site-description" itemprop="description">我以為我可以獨自過一生 我還是被打動了</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">45</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">32</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AAAAsea" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AAAAsea" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://space.bilibili.com/470490357" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;470490357" rel="noopener" target="_blank"><i class="fa fa-tv fa-fw"></i> Bilibili</a></span><span class="links-of-author-item"><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=569389750&amp;site=qq&amp;menu=yes" title="QQ → http:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;569389750&amp;site&#x3D;qq&amp;menu&#x3D;yes" rel="noopener" target="_blank"><i class="fab fa-qq fa-fw"></i> QQ</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/michael-48-84-31" title="ZhiHu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;michael-48-84-31" rel="noopener" target="_blank"><i class="fab fa-black-tie fa-fw"></i> ZhiHu</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://asea.fun/" title="https:&#x2F;&#x2F;asea.fun">我的主页</a></li><li class="links-of-blogroll-item"> <a href="https://blog.asea.fun/" title="https:&#x2F;&#x2F;blog.asea.fun" rel="noopener" target="_blank">Butterfly主题博客</a></li><li class="links-of-blogroll-item"> <a href="https://alicee.run/" title="https:&#x2F;&#x2F;alicee.run" rel="noopener" target="_blank">Alice Wonderland博客</a></li><li class="links-of-blogroll-item"> <a href="/fun/apesk/" title="&#x2F;fun&#x2F;apesk&#x2F;">APESK-荣格理论测试</a></li><li class="links-of-blogroll-item"> <a href="https://game01.asea.fun/" title="https:&#x2F;&#x2F;game01.asea.fun" rel="noopener" target="_blank">生长方块</a></li><li class="links-of-blogroll-item"> <a href="https://game02.asea.fun/" title="https:&#x2F;&#x2F;game02.asea.fun" rel="noopener" target="_blank">奔跑吧小球</a></li><li class="links-of-blogroll-item"> <a href="https://game03.asea.fun/" title="https:&#x2F;&#x2F;game03.asea.fun" rel="noopener" target="_blank">见缝插针</a></li><li class="links-of-blogroll-item"> <a href="https://hole.asea.fun/" title="https:&#x2F;&#x2F;hole.asea.fun" rel="noopener" target="_blank">合成黑洞</a></li><li class="links-of-blogroll-item"> <a href="/fun/mi/" title="&#x2F;fun&#x2F;mi&#x2F;">随机密码</a></li><li class="links-of-blogroll-item"> <a href="/fun/chi/" title="&#x2F;fun&#x2F;chi&#x2F;">吃什么</a></li><li class="links-of-blogroll-item"> <a href="/fun/du/" title="&#x2F;fun&#x2F;du&#x2F;">毒鸡汤</a></li><li class="links-of-blogroll-item"> <a href="/fun/hua/" title="&#x2F;fun&#x2F;hua&#x2F;">画板</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2019 – <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">©2021 by Asea</span></div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("12/14/2019 22:08:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已偷偷运行 "+dnum+" 天",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script><div class="theme-info"><div class="powered-by"></div> <span class="post-count">全站共49.1k字</span></div><div class="busuanzi-count"><script async src="/lib/busuanzi.pure.min.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style=""><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style=""><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script defer="defer" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js"></script><script defer="defer" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three-waves.min.js"></script><script src="/js/local-search.js"></script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'Nh54YkjOBcUzuCYRfY0LerTh-MdYXbMMI',
      appKey     : 'XeawwdLURQJN3MnHMpcY9sm3',
      placeholder: "在这里评论",
      avatar     : 'retro',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
    
  }, window.Valine);
});
</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/hijiki.model.json"},display:{position:"right",width:170,height:340},mobile:{show:!1},log:!1})</script></body></html>